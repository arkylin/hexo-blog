---
title: é˜¿é‡Œäº‘äº‘å‡½æ•°é…ç½®ç™¾åº¦è‡ªåŠ¨æ¨é€
categories:
  - [é˜¿é‡Œäº‘]
tags:
  - [é˜¿é‡Œäº‘]
date: 2020-07-06 21:57:28
translate_title: Alibaba-Cloud-Cloud-function-configuration-Baidu-automatic-push
keywords: è‡ªåŠ¨æ¨é€,ç™¾åº¦
description: å®ç°æµè§ˆæ–‡ç« æ—¶è‡ªåŠ¨æ¨é€é“¾æ¥åˆ°ç™¾åº¦
top_img: baidu_push.png
comments:
cover: baidu_push.png
toc:
toc_number:
copyright:
mathjax:
katex:
hide:
top:
---
å®ç°æµè§ˆæ–‡ç« æ—¶è‡ªåŠ¨æ¨é€é“¾æ¥åˆ°ç™¾åº¦

å¦‚å›¾
<img src="baidu_push.png" width="100%" alt="baidu_push">

```Python index.py
import requests
import re
import json
from flask import Flask, request

app = Flask(__name__)

@app.route('/baidu-push', methods=['GET'])
def baidu_push():
    data = str(request.referrer)
    #data = 'https://www.xyz.blue/'
    if data != "":
      if re.match(r'https://.*domain.name.*', data): #é˜²æ»¥ç”¨åŸŸåæ¨é€é™åˆ¶
        url = "http://data.zz.baidu.com/urls?site=https://domain.name&token=your_token"
        headers = {
          'User-Agent': 'curl/7.12.1',
          'Host': 'data.zz.baidu.com',
          'Content-Type': 'text/plain',
          'Content-Length': '83'
        }
        res = requests.post(url, headers=headers, data=data).text
        text = json.loads(res)
        if text['success'] == 1:
          return "{'Res': 'Success'" + "," + "'Remain':" + " " + str(text['remain']) + "}"
        else:
          return "{'Res': 'Fail'}"
      else:
        return "{'Res': 'Not_Same_Site'}"
    else:
      return "{'Res': 'None'}"

if __name__ == '__main__':
    app.run()
```
å‡½æ•°é…ç½®
```Yaml template.yml
ROSTemplateFormatVersion: '2015-09-01'
Transform: 'Aliyun::Serverless-2018-04-03'
Resources:
  Blog:
    Type: 'Aliyun::Serverless::Service'
    Properties:
      Role: 'acs:ram::ID:role/AliyunFCLogExecutionRole'
      LogConfig:
        Project: aliyun-fc-ap-southeast-1-ID
        Logstore: function-log
      InternetAccess: true
    baidu-push:
      Type: 'Aliyun::Serverless::Function'
      Properties:
        Handler: index.app
        Runtime: python3
        Timeout: 5
        MemorySize: 128
        CodeUri: Blog\baidu-push
      Events:
        baidu-push:
          Type: HTTP
          Properties:
            AuthType: ANONYMOUS
            Methods:
              - GET
```
Hexo-Butterflyé…ç½®
åœ¨`layout-include-head.pug`çš„é€‚å½“åœ°æ–¹æ’å…¥ä»¥å®ç°è‡ªåŠ¨åŠ è½½
```Js Example
<script type="text/javascript" defer="" src="https://api.domain.name/baidu-push"></script>
```

æœ€åå‘ç°å…¶å®å¯ä»¥ç›´æ¥ç”¨ç™¾åº¦æä¾›çš„é¢ğŸ¤£ğŸ¤£ğŸ¤£ ğŸ‘€
```Js Example
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https'){
   bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else{
  bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>
```